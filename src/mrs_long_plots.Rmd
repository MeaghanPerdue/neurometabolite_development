---
title: "mrs_long_plots"
author: "Meaghan Perdue"
date: "1/7/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(root.dir = '/Users/meaghan/OneDrive - University of Calgary/Preschool_data/MRS/data/')
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(patchwork)
```

## Plot participant ages/timepoints
```{r}
#read in data
acg_dat <- read.csv("/Users/meaghan/OneDrive - University of Calgary/Preschool_data/MRS/data/acg_data_molal_outliers_removed_n113.csv")

lag_dat<-read.csv("/Users/meaghan/OneDrive - University of Calgary/Preschool_data/MRS/data/lag_data_molal_outliers_removed_n320.csv")

#filter by age at 1st MRI session (1 row/subject), order by age at first session
acg_age_ses1 <- acg_dat %>% 
  group_by(subj_id) %>%
  filter(mri_age_y == min(mri_age_y)) %>% 
  arrange(mri_age_y)
#create subject ID variable by order of age at first MRI
acg_age_ses1$id_by_age_ses1 <- seq.int(nrow(acg_age_ses1))

#select only subj_id and acg_age_ses1 columns
acg_subj_id_age_index <- acg_age_ses1 %>%
  dplyr::select(subj_id, id_by_age_ses1)

#join index df to acg_dat
acg_dat_age_index<-left_join(acg_dat, acg_subj_id_age_index, by = "subj_id")

p1<-ggplot(acg_dat_age_index, aes(x=mri_age_y, y=id_by_age_ses1, color=as.factor(female)))

plot_acg_sessions<-p1 + 
  geom_point() +
  geom_line(aes(group = as.factor(id_by_age_ses1))) +
  labs(title = "Anterior Cingulate", x = "Age (years)", y = "Participant") +
   scale_x_continuous(limits = c(1, 8), n.breaks = 7) +
  scale_color_manual(values = c("blue", "red"),name = "Sex", labels = c("Male", "Female")) +
  theme_classic() +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), legend.position = "none")
plot_acg_sessions
ggsave("/Users/meaghan/OneDrive - University of Calgary/Preschool_data/MRS/results/acg_timepoints.png")


#filter by age at 1st MRI session (1 row/subject), order by age at first session
lag_age_ses1 <- lag_dat %>% 
  group_by(subj_id) %>%
  filter(mri_age_y == min(mri_age_y)) %>% 
  arrange(mri_age_y)
#create subject ID variable by order of age at first MRI
lag_age_ses1$id_by_age_ses1 <- seq.int(nrow(lag_age_ses1))

#select only subj_id and lag_age_ses1 columns
lag_subj_id_age_index <- lag_age_ses1 %>%
  dplyr::select(subj_id, id_by_age_ses1)

#join index df to lag_dat
lag_dat_age_index<-left_join(lag_dat, lag_subj_id_age_index, by = "subj_id")

p2<-ggplot(lag_dat_age_index, aes(x=mri_age_y, y=id_by_age_ses1, color=as.factor(female)))

plot_lag_sessions<-p2 + 
  geom_point() +
  geom_line(aes(group = as.factor(id_by_age_ses1))) +
  labs(title = "Left Temporo-Parietal", x = "Age (years)", y = "Participant") +
  scale_x_continuous(limits = c(1, 12), n.breaks = 11) +
  scale_color_manual(values = c("blue", "red"),name = "Sex", labels = c("Male", "Female")) +
  theme_classic() +
  theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), legend.position = "none")
plot_lag_sessions
ggsave("/Users/meaghan/OneDrive - University of Calgary/Preschool_data/MRS/results/lag_timepoints.png")

#combine into a single figure
session_fig<-plot_acg_sessions + plot_lag_sessions + plot_layout(nrow=1)
session_fig
ggsave("/Users/meaghan/OneDrive - University of Calgary/Preschool_data/MRS/results/session_timepoints_fig.png", height = 7, width = 14)

```

